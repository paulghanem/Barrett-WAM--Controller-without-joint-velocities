function G=G1(q)


DH_a = [0 0 0.045 -0.045];
    DH_d = [0 0 .55 0 ];
    DH_alpha = [-pi/2 pi/2 -pi/2 pi/2];

    m = [10.7676 3.87 1.8022 1.06513649];    
     
    com= zeros(3,4);
    
   com(:,1) = [-0.00443422;0.12189039;-0.00066489];
    com(:,2) = [-0.00236983;0.03105614;0.01542114 ];
    com(:,3) = [-0.03825858;0.20750770;0.00003309];
    com(:,4) = [0.01095471;-0.00002567;0.14053900 ];
 
        
     I=zeros(3,3,4);
    T=zeros(4,4);
     I(:,:,1) = [0.29486350,-0.00795023,-0.00009311;
                 -0.00795023,0.11350017,-0.00018711;
                -0.00009311,-0.00018711,0.25065343];
    I(:,:,2) =[0.02606840,-0.00001346,-0.00011701;
               -0.00001346,0.01472202,0.00003659;
              -0.00011701,0.00003659,0.01934814];
    I(:,:,3) = [0.13671601,-0.01680434, 0.00000510;
               -0.01680434,0.00588354,-0.00000530;
                0.00000510,-0.00000530,0.13951371];
     I(:,:,4) = [ 0.03952350,0.00000189,0.00003117;
                 0.00000189,0.04008214,-0.00000131;
                 0.00003117,-0.00000131,0.00210299] ;
    
            
             
             
for j=1:4,
        a = DH_a(j);
        d = DH_d(j);
        alpha = DH_alpha(j);
        T(:,:,j) = getTransformDH(a, d, alpha, q(j));
end 

comstar=zeros(4,4);

   
    comstar(:,1) = [com(:,1);1];
    comstar(:,2) = [com(:,2);1];
    comstar(:,3) = [com(:,3);1];
    comstar(:,4) = [com(:,4);1];
    
    Q=zeros(4,4);
    
    Q=[0,-1,0,0;
     1,0,0,0;
     0,0,0,0;
     0,0,0,0];
   
   
 gravity=[0,0,-9.81,0];
 
   G(1)= -m(1)*gravity*Q*T(:,:,1)*comstar(:,1)-m(2)*gravity*Q*T(:,:,1)*T(:,:,2)*comstar(:,2)-m(3)*gravity*Q*T(:,:,1)*T(:,:,2)*T(:,:,3)*comstar(:,3)-m(4)*gravity*Q*T(:,:,1)*T(:,:,2)*T(:,:,3)*T(:,:,4)*comstar(:,4);   
   G(2)= -m(2)*gravity*T(:,:,1)*Q*T(:,:,2)*comstar(:,2)-m(3)*gravity*T(:,:,1)*Q*T(:,:,2)*T(:,:,3)*comstar(:,3)-m(4)*gravity*T(:,:,1)*Q*T(:,:,2)*T(:,:,3)*T(:,:,4)*comstar(:,4);
   G(3)= -m(3)*gravity*T(:,:,1)*T(:,:,2)*Q*T(:,:,3)*comstar(:,3)-m(4)*gravity*T(:,:,1)*T(:,:,2)*Q*T(:,:,3)*T(:,:,4)*comstar(:,4);
   G(4)= -m(4)*gravity*T(:,:,1)*T(:,:,2)*T(:,:,3)*Q*T(:,:,4)*comstar(:,4);
end 
    function T = getTransformDH(a,d,alpha,q)
    ct = cos(q);
    st = sin(q);
    cb = cos(alpha);
    sb = sin(alpha);
    
    T = [ ct, -st*cb,  st*sb, a*ct;
          st,  ct*cb, -ct*sb, a*st;
          0, sb, cb, d;
          0, 0, 0, 1 ];            
 end       